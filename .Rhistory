geom_point(position = 'jitter', size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings",
y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 4) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings",
y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings",
y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings",
y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color=State))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings. vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_point(position = 'jitter', size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_bar(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_bar(stat='identity') +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_bar() +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_histogram() +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_dotplot() +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, fill = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(shootings_good_states, aes(x = Law_Score, y = Freq, color = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
shootings_good_states$Employeed..Y.N. <- NULL
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
View(plotting_data)
plotting_data <- na.omit(plotting_data)
## Add a nice little plot
ggplot(plotting_data, aes(x = Law_Score, y = Freq, color = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
View(plotting_data)
levels(plotting_data$State)
levels(plotting_data$Law_Score)
plotting_data$Law_Score <- factor(plotting_data$Law_Score)
## Add a nice little plot
ggplot(plotting_data, aes(x = Law_Score, y = Freq, color = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
## Add a nice little plot
ggplot(plotting_data, aes(x = Law_Score, y = Freq, color = State))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs the Difficulty of Acquiring a Gun") +
geom_smooth()
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs the Difficulty of Acquiring a Gun")
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs the Difficulty of Acquiring a Gun") +
geom_smooth()
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs the Difficulty of Acquiring a Gun") +
geom_smooth()
View(plotting_data)
unique(plotting_data)
plotting_data <- unique(plotting_data)
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs the Difficulty of Acquiring a Gun") +
geom_smooth()
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(size = 2) +
xlim(0, 5) +
labs(x = "Open carry/Magazine restrictions", y = "Amount of mass shootings") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions")
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Difficulty to acquire a gun") +
ggtitle("Number of Shootings. vs the Difficulty of Acquiring a Gun") +
geom_smooth()
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Open Carry and Magazine Laws") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions") +
geom_smooth()
data.frame(table(shootings_good_states$Gender))
##---------------------------------------------------------------------------##
##---------Load data Set----------##
shootings <- read.csv('cleaned_shootings1', stringsAsFactors = FALSE)
## -- Some pre-cleaning -- ##
## Remove unkown genders
shootings$Gender[shootings$Gender == "Unknown"] <- NA
shootings <- na.omit(shootings)
##---------------------------------------------------------------------------##
##                                                                           ##
##                              PLOTTING                                     ##
##---------------------------------------------------------------------------##
## -- Plot some initial results -- ##
## Basic plots
## How many males and females are responsible for mass shootings?
ggplot(shootings, aes(x = Gender)) +
geom_bar(fill='darkred') +
labs(y = "Amount of Mass Shootings") +
theme(text = element_text(size = 20))
## Show differences between gender and total victims
ggplot(shootings, aes(x = Gender, y = Total_Victims) ) +
geom_bar(stat='identity', fill='darkred') +
labs(y = "Amount of Deaths") +
theme(text = element_text(size = 20))
## Show differences between race, gender and total_victims
ggplot(shootings, aes(x = Gender, y = Total_Victims, fill = Race) ) +
geom_bar(stat='identity',position='dodge') +
labs(y = "Amount of Deaths") +
theme(text = element_text(size = 20))
## Error bars for gender and amount of kills
mean_kills <- shootings %>% group_by(Gender) %>%
summarize(ymin = min(Total_Victims),
ymax = max(Total_Victims),
ymean = mean(Total_Victims))
ggplot(mean_kills, aes(x = Gender, y = ymean)) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
labs(y = "Amount of Deaths") +
theme(text = element_text(size = 20))
data.frame(table(shootings$Gender))
##---------------------------------------------------------------------------##
##                                                                           ##
##                            ANALYSES                                       ##
##---------------------------------------------------------------------------##
## Remove male/female duo mass-shootings:
shootings$Gender[shootings$Gender == 'Male/Female'] <- NA
shootings <- na.omit(shootings)
data.frame(table(shootings$Gender))
a <- data.frame(table(shootings$Gender))
t.test(a$Var1, a$Freq)
t.test(a$Freq~a$Var1)
## Load the cleaned dataSet
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
## Load the laws dataSet
laws <- read.csv('Laws.csv', stringsAsFactors = FALSE)
open_carry_magazines <- select(laws, X, Open.carry.allowed_H, Open.carry.allowed_L,
Magazine.size.restriction_H,
Magazine.size.restriction_L)
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Open Carry and Magazine Laws") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions") +
geom_smooth()
plotting_data <- unique(plotting_data)
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Open Carry and Magazine Laws") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions") +
geom_smooth()
## Load the cleaned dataSet
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
## Load the laws dataSet
laws <- read.csv('Laws.csv', stringsAsFactors = FALSE)
open_carry_magazines <- select(laws, X, Open.carry.allowed_H, Open.carry.allowed_L,
Magazine.size.restriction_H,
Magazine.size.restriction_L)
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
plotting_data <- unique(plotting_data)
#plotting_data$Law_Score <- factor(plotting_data$Law_Score)
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Open Carry and Magazine Laws") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions") +
geom_smooth()
## Load the cleaned dataSet
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
## Load the laws dataSet
laws <- read.csv('Laws.csv', stringsAsFactors = FALSE)
open_carry_magazines <- select(laws, X, Open.carry.allowed_H, Open.carry.allowed_L,
Magazine.size.restriction_H,
Magazine.size.restriction_L)
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
plotting_data <- unique(plotting_data)
#plotting_data$Law_Score <- factor(plotting_data$Law_Score)
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Open Carry and Magazine Laws") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions") +
geom_smooth()
## Load the cleaned dataSet
shootings_good_states <- read.csv('State_Clean_Shootings.csv',
stringsAsFactors = FALSE, header = TRUE)
shootings_good_states$X <- NULL
## Load the laws dataSet
laws <- read.csv('Laws.csv', stringsAsFactors = FALSE)
open_carry_magazines <- select(laws, X, Open.carry.allowed_H, Open.carry.allowed_L,
Magazine.size.restriction_H,
Magazine.size.restriction_L)
colnames(open_carry_magazines)[1] <- "State"
shootings_good_states <- left_join(shootings_good_states, open_carry_magazines,
by='State')
## Change values of state lax on open_carry and magazine restrictions
shootings_good_states[14:15][shootings_good_states[14:15] != "Y"] <- 0
shootings_good_states[14:15][shootings_good_states[14:15] == "Y"] <- 1
shootings_good_states[16:17][shootings_good_states[16:17] != "N"] <- 0
shootings_good_states[16:17][shootings_good_states[16:17] == "N"] <- 1
## Change the values to numeric ones
shootings_good_states[,14:17] <- sapply(shootings_good_states[,14:17],as.numeric)
sapply(shootings_good_states, class)
## Add column with score
shootings_good_states[18] <- rowSums(shootings_good_states[,14:17])
colnames(shootings_good_states)[18] <- 'Law_Score'
## Change it to factors
shootings_good_states$State <- factor(shootings_good_states$State)
## Add frequency per state
shootings_nr <- data.frame(table(shootings_good_states$State))
colnames(shootings_nr)[1] <- 'State'
shootings_good_states <- left_join(shootings_good_states, shootings_nr, by='State')
plotting_data <- select(shootings_good_states, State, Freq, Law_Score)
plotting_data <- na.omit(plotting_data)
plotting_data <- unique(plotting_data)
#plotting_data$Law_Score <- factor(plotting_data$Law_Score)
## Add a nice little plot
ggplot(plotting_data, aes(x = Freq, y = Law_Score, color = Law_Score))+
geom_point(position = "jitter", size = 2) +
xlim(0, 35) +
scale_color_gradient(low = "yellow", high = "darkred") +
labs(color = "Degree of difficulty \n to acquire a gun", x = "Mass shootings", y = "Open Carry and Magazine Laws") +
ggtitle("Number of Shootings vs Open cary and magazine restrictions") +
geom_smooth()
rm(plotting_data)
rm(open_carry_magazines)
rm(laws)
rm(shootings_good_states)
rm(shootings_nr)
